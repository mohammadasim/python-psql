# connection_pool = pool.SimpleConnectionPool(1,
#                                             1,
#                                             database='app',
#                                             user='postgres',
#                                             password='password123',
#                                             host='localhost')
#
#
# class ConnectionFromPool:
#     '''
#     The __enter__() and __exit__() methods are required by the with statement in the user class
#     The __enter__() method gets called at the beginning of the of the with statement, while
#     the __exit__() method gets called at the end of the with statement.
#     It is important that we commit the connection as now this class is dealing with a single connection at a time.
#     '''
#
#     def __init__(self):
#         self.connection = None
#
#     def __enter__(self):
#         self.connection = connection_pool.getconn()
#         return self.connection
#
#     def __exit__(self, exc_type, exc_val, exc_tb):
#         self.connection.commit()
#         connection_pool.putconn(self.connection)



    def save_to_db(self):
        # with get_connection('postgres', 'password123', 'app') as connection:
        #     with connection.cursor() as cursor:
        #         cursor.execute('INSERT INTO users (email, first_name, last_name) VALUES (%s, %s, %s)',
        #                        (self.email, self.first_name, self.last_name))
        db = get_connection('postgres', 'password123', 'app')
        db.execute('INSERT INTO users (email, first_name, last_name) VALUES (%s, %s, %s)',
                   (self.email, self.first_name, self.last_name))

    @classmethod
    def load_from_db_by_email(cls, email):
        # with get_connection('postgres', 'password123', 'app') as connection:
        #     with connection.cursor() as cursor:
        #         cursor.execute('select * from users where email=%s', (email,))
        #         user_data = cursor.fetchone()
        #         return cls(email=user_data[1], first_name=user_data[2], last_name=user_data[3], id=user_data[0])
        db = get_connection('postgres', 'password123', 'app')
        result = db.execute('select * from users where email=%s', (email,))
        user_data = result.fetchone()
        return cls(email=user_data[1], first_name=user_data[2], last_name=user_data[3], id=user_data[0])
